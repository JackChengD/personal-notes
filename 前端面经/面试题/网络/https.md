# https

## SSL加密过程

客户端产生随机数，然后用公钥进行随机数加密后发送给服务端，服务端用私钥进行解密，解密后拿到客户端的随机数，然后用随机数对数据进行对称加密，发送给客户端。此外客户端可以验证服务端的身份，如果配置了客户端验证，服务器方也可以验证客户端的身份。  
常见的对称加密有：DES、3DES、IDES；  
常见的非对称加密有：RSA；  

## 中间人劫持

1、本地请求被劫持（如DNS劫持等），所有请求均发送到中间人的服务器  
2、中间人服务器返回中间人自己的证书和公钥给客户端  
3、客户端验证通过  
4、客户端创建随机数，通过中间人证书的公钥对随机数加密后传送给中间人，然后凭随机数构造对称加密对传输内容进行加密传输  
5、中间人因为拥有客户端的随机数，可以通过对称加密算法进行内容解密  
6、中间人以客户端的请求内容再向正规网站发起请求  
7、因为中间人与服务器的通信过程是合法的，正规网站通过建立的安全通道返回加密后的数据  
8、中间人凭借与正规网站建立的对称加密算法对内容进行解密  
9、中间人通过与客户端建立的对称加密算法对正规内容返回的数据进行加密传输  
10、客户端通过与中间人建立的对称加密算法对返回结果数据进行解密  

参考：https://juejin.cn/post/6844904065227292685  

中间人很难破解的原因:  
虽然中间人可以得到证书，但私钥是无法获取的，一份公钥是不可能推算出其对应的私钥，中间人即使拿到证书也无法伪装成合法服务端，因为无法对客户端传入的加密数据进行解密。  
