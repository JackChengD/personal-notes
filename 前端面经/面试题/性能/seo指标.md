# seo指标

## LCP（显示最大内容所需的时间）

### 定义

LCP注重页面中最大元素的加载速度。而google是怎么确定最大的元素呢？加载页面时，google回抓取页面可视范围内最大的元素，并随时可以改变可视范围内的内容。在页面加载完全之前，页面中最大的元素将被设置为LCP

### 检测项

- `<img>`元素
- 内嵌在`<svg>`元素内的`<image>`元素
- `<video>`元素（使用封面图像）
- 通过url()函数（而非使用CSS 渐变）加载的带有背景图像的元素
- 包含文本节点或其他行内级文本元素子元素的块级元素。

### 优化

- 缩短服务器响应时间
- 针对主机优化
- cdn加速
- 缓存（浏览器、接口、html资源、redis）
- 第三方资源尽早加载
- 减少js阻塞时间
- 减少css阻塞时间
- 减少dom树和css dom树结合时间
- 图片优化（尺寸、大小、懒加载、雪碧图、预加载、gif转png、webp）
- 预加载重要资源
- 压缩文本文件
- 根据用户的网络状态提供不同的内容
- 开启http2
- gzip
- dns预连接
- dns预解析
- 不写嵌套css，采用BEM规范
- 第三方资源拆chunk
- 避免csr，如果一定要csr，尽量优化js避免渲染时使用太多资源
- 尽量ssr，服务端完成页面渲染，客户端直接渲染内容

### 衡量

- good值2.5s及以下

### 其他

- 触发时机：首次（没有往返缓存（bfcache））时发生键入或点击，非首次进入页面就触发（有往返缓存）
- 触发次：多次。两次visibilitychange触发之间，只1次
- 值：首次时largest-contentful-paint完成所需要毫秒数，非首次时两帧图像渲染的时间戳差值
- 偏移量：与值相同。两种触发场景下，两次visibilitychange触发之间都只触发一次

### 参考

[Largest Contentful Paint 最大内容绘制 (LCP)](https://web.dev/lcp/)

## CLS（累积布局偏移）-页面稳定性

### 定义

- 可预见性：当你在网站点击内容反馈的fold功能，fold引起的页面布局偏移时可以预见的，google不会将此判断为页面的不稳定
- 不可预见性：意外的布局偏移通常时由网页中元素的加载顺序不同引起的。比如，只有在加载文本框后才会加载的按钮，这会导致用户在阅读过程中移动内容。这种对用户的意外布局偏移将影响cls指标

### 检测项

所有元素

### 优化

- 通过css为网页中的元素提供预留空间，以避免加载后页面中的内容移动
- 通过元素（字体、图片等）这将导致页面内容提前被加载
- 提升字体加载优先级

### 衡量

- 布局偏移分数 = 影响分数 * 距离分数
- good值0.1及以下

### 其他

- 触发时机：每次页面隐藏（导航到其他网页或者切应用）
- 触发次数：多次，两次visibilitychange触发之间，只1次
- 值：**五秒内**layout-shift触发的entry值的和，没有触发entry就是0
- 偏移量：当次与上一次的差值

### 参考

[Cumulative Layout Shift 累积布局偏移 (CLS)](https://web.dev/cls/)

## FID（首次输入延迟）- 可开始交互的时间

### 定义

- 第一次输入与页面上的相应元素密切相互。这些相应组件可以时连接、按钮或弹出窗口。
- 输入延迟通常发生在浏览器主执行太忙，导致页面内容无法与用户正确交互的时候。例如，浏览器肯恶搞正在加载一个相当大的js文件，这导致其他元素无法加载，并延迟了交互时间

### 检测项

- 点击连接或按钮加载内容延迟
- 文本对话框不能立即输入文本
- 打开下拉菜单屏幕延迟
- 无法检查对话框

### 优化

- 减少js操作时间
- 较少对网页请求数量并较小文件大小
- 减少主要流程的工作量
- 减少第三方代码的影响

### 衡量

- good值100ms及有以下

### 其他

- 触发时机：第一次输入（手指或鼠标点击，键入）
- 触发次数：多次。两次visibilitychange触发之间，只1次
- 值：输入事件触发的时间戳与js下一段逻辑代码执行所在的时间点之间差值
- 偏移量：与值相同，代码里记录一次值就移除了相关的事件监听

## 参考

- [谷歌网站Core web vitals(LCP、FID、CLS)的核心指标是什么？SEO五大重点优化](https://www.yestupa.com/google-seo-core-web-vitals.html)
- [web-vitals 源码阅读](https://juejin.cn/post/7083301090707374087#heading-5)
